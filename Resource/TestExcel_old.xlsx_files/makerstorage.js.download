!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=14)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(15);t.getAccessToken=n.getAccessToken,t.getMlapiAccessToken=n.getMlapiAccessToken,t.getUserId=n.getUserId,t.setUserAccessInfo=n.setUserAccessInfo,t.setAdminAccessToken=n.setAdminAccessToken,t.getAdminAccessToken=n.getAdminAccessToken;var o=r(16);t.setNodeFetch=o.setNodeFetch,t.usingNodeFetch=o.usingNodeFetch;var i=r(8);t.getDelay=i.getDelay,t.inDevMode=i.inDevMode,t.useLocalStorage=i.useLocalStorage;var c=r(17);t.getSessionId=c.getSessionId,t.setSessionId=c.setSessionId;var s=r(18);t.buildAdminUrl=s.buildAdminUrl,t.buildStorageUrl=s.buildStorageUrl,t.setStorageEnvironmentOverride=s.setStorageEnvironmentOverride},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function c(e){try{a(n.next(e))}catch(e){i(e)}}function s(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(c,s)}a((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,n=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=c.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(31);t.makeGetRequest=function(e,t,r){return n(this,void 0,void 0,(function(){var n;return o(this,(function(o){return n={customHeaders:r},[2,i.makeHttpRequest(e,"GET",n,t)]}))}))},t.makePostRequest=function(e,t,r,c){return n(this,void 0,void 0,(function(){var n;return o(this,(function(o){return n={requestBody:t,customHeaders:c},[2,i.makeHttpRequest(e,"POST",n,r)]}))}))},t.makePutRequest=function(e,t,r,c){return n(this,void 0,void 0,(function(){var n;return o(this,(function(o){return n={requestBody:t,customHeaders:c},[2,i.makeHttpRequest(e,"PUT",n,r)]}))}))},t.makePatchRequest=function(e,t,r,c){return n(this,void 0,void 0,(function(){var n;return o(this,(function(o){return n={requestBody:t,customHeaders:c},[2,i.makeHttpRequest(e,"PATCH",n,r)]}))}))},t.makeDeleteRequest=function(e,t,r){return n(this,void 0,void 0,(function(){var n;return o(this,(function(o){return n={customHeaders:r},[2,i.makeHttpRequest(e,"DELETE",n,t)]}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.LocalStorageKeys={recordedScriptsKey:"recorded-maker-scripts",lastOpenedScriptKey:"last-opened-script"},t.CXPSStrings={Namespace:"http://schemas.microsoft.com/office/extensibility/maker/v1.0",ScriptIdNodeTag:"scriptId",ScriptIdsNodeId:"script-ids-node-id"},t.StorageResourceIdFirstParty="https://officescripting.microsoft.com",t.StorageResourceIdFirstPartyTest="https://officescripting-test.microsoft.com",t.StorageResourceIdThirdParty="93649854-d49a-4352-9737-280fbe867971",t.SERVICE_URLS={prod:"https://api.public.officescriptsservice.com/api",int:"https://api.runtime.arbitraryrunner.com/api",test:"https://api.test.arbitraryrunner.com/api",local:"http://localhost:30002/api"},t.MLAPI_MAKER_SCOPE="Microsoft.Internal.OfficeScriptingConsentScopes",t.MLAPI_URL="https://substrate.office.com/profile/v1.0/me/allExtensions/Microsoft.Internal.OfficeScriptingConsentScopes",t.MAX_SCRIPT_NAME_LENGTH=80,t.MAX_SCRIPT_DESCRIPTION_LENGTH=500,t.SIMULATED_DELAY=50,t.NUM_MILLISECONDS_PER_SECOND=1e3},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function c(e){try{a(n.next(e))}catch(e){i(e)}}function s(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(c,s)}a((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,n=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=c.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.generateNextScriptName=function(e,t,r){if(void 0===r&&(r=!1),e.includes(t)||!r){for(var n=1;e.includes(t+" ("+n+")");)n++;return t+" ("+n+")"}return t},t.pause=function(e){return n(this,void 0,void 0,(function(){return o(this,(function(t){return[2,new Promise((function(t){return setTimeout(t,e)}))]}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(26);t.addScriptToLocalStorage=n.addScriptToLocalStorage;var o=r(27);t.getScriptFromLocalStorage=o.getScriptFromLocalStorage;var i=r(28);t.getScriptsFromLocalStorage=i.getScriptsFromLocalStorage;var c=r(29);t.removeScriptFromLocalStorage=c.removeScriptFromLocalStorage;var s=r(30);t.updateScriptOnLocalStorage=s.updateScriptOnLocalStorage},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);function o(e){var t={};return e.forEach((function(e,r){return t[r]=e})),t}t.getScriptsMap=function(){var e=JSON.parse(localStorage.getItem(n.LocalStorageKeys.recordedScriptsKey)||"{}");return new Map(Object.entries(e))},t.updateLocalStorage=function(e){window.localStorage.setItem(n.LocalStorageKeys.recordedScriptsKey,JSON.stringify(o(e)))},t.convertMapToObject=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(19);t.createScript=n.createScript;var o=r(9);t.getScript=o.getScript;var i=r(10);t.getScripts=i.getScripts;var c=r(34);t.getSharedScript=c.getSharedScript;var s=r(35);t.getSharedScripts=s.getSharedScripts;var a=r(36);t.removeScript=a.removeScript;var u=r(37);t.saveScript=u.saveScript;var l=r(11);t.isScriptDescriptionValid=l.isScriptDescriptionValid,t.isScriptNameValid=l.isScriptNameValid;var f=r(40);t.shareScript=f.shareScript;var d=r(41);t.unshareScript=d.unshareScript},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(23),o=r(24),i=r(25);function c(e){var t=e.split(".");if(2===t.length)return{major:parseInt(t[0],10),minor:parseInt(t[1],10)};throw new Error("Invalid version")}t.convertResponseJson=function(e,t){if(null==t)return n.convertResponseToScriptV0(e);var r=c(t);switch(r.major){case 2:return i.convertResponseToScriptV2(e,r.minor);case 1:return o.convertResponseToScriptV1(e);default:throw new Error("Unsupported version")}},t.convertResponseJsonArray=function(e,t){if(null==t)return n.convertResponseToScriptCoresV0(e);var r=c(t);switch(r.major){case 2:return i.convertResponseToScriptCoresV2(e,r.minor);case 1:return o.convertResponseToScriptCoresV1(e);default:throw new Error("Unsupported version")}}},function(e,t,r){"use strict";var n,o;Object.defineProperty(t,"__esModule",{value:!0}),t.useLocalStorage=function(e,t){if(!e)return n=null,void(o=0);n=e,o=t||0},t.inDevMode=function(){return!!n},t.getDelay=function(){return o}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function c(e){try{a(n.next(e))}catch(e){i(e)}}function s(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(c,s)}a((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,n=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=c.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(7),c=r(3),s=r(4),a=r(0),u=r(1);function l(e,t){return n(this,void 0,void 0,(function(){var r,n,c;return o(this,(function(o){switch(o.label){case 0:return[4,u.makeGetRequest(e,a.getAccessToken(),{"x-ms-client-request-id":t,"X-UserSessionId":a.getSessionId()})];case 1:return[4,(r=o.sent()).json()];case 2:return n=o.sent(),c=r.headers.get("Version"),[2,i.convertResponseJson(n,c)]}}))}))}t.getScriptInternal=l,t.getScript=function(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return a.inDevMode()?[4,c.pause(a.getDelay())]:[3,2];case 1:return r.sent(),[2,s.getScriptFromLocalStorage(e)];case 2:return[2,l(a.buildStorageUrl()+"/"+e,t)]}}))}))}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function c(e){try{a(n.next(e))}catch(e){i(e)}}function s(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(c,s)}a((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,n=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=c.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(7),c=r(3),s=r(4),a=r(0),u=r(1);function l(e,t){return n(this,void 0,void 0,(function(){var r,n,c;return o(this,(function(o){switch(o.label){case 0:return[4,u.makeGetRequest(e,a.getAccessToken(),{"x-ms-client-request-id":t,"X-UserSessionId":a.getSessionId()})];case 1:return[4,(r=o.sent()).json()];case 2:return n=o.sent(),c=r.headers.get("Version"),[2,i.convertResponseJsonArray(n,c)]}}))}))}t.getScriptsInternal=l,t.getScripts=function(e){return n(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return a.inDevMode()?[4,c.pause(a.getDelay())]:[3,2];case 1:return t.sent(),[2,s.getScriptsFromLocalStorage()];case 2:return[2,l(a.buildStorageUrl(),e)]}}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);t.isScriptNameValid=function(e){var t=new RegExp(/^(\s*)$/);if(!e.length||t.test(e))return{error:"Name is empty"};if(e.length>n.MAX_SCRIPT_NAME_LENGTH)return{error:"Name is too long"};var r=new RegExp(/(^((\.lock)|(CON)|(PRN)|(AUX)|(NUL)|(COM\d{1})|(LPT\d{1})|(desktop.ini))$)|(_vti_)|(^~\$)/),o=e.match(r);if(o)return{error:"Invalid name",invalidSubstring:o[0]};var i=new RegExp(/(["*:<>?\/\\|%&\.])/),c=e.match(i);if(c)return{error:"Name contains invalid character",invalidSubstring:c[0]};var s=new RegExp(/([\s]$)/);return e.match(s)?{error:"Name ends in whitespace"}:{error:"None"}},t.isScriptDescriptionValid=function(e){return e.length<=n.MAX_SCRIPT_DESCRIPTION_LENGTH}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);t.mockAccessToken="eyBearerAuthmockAccessTokenfromGraphtobeSenttoRest",t.mockMlapiAccessToken="eyBearerAuthmockMLAPITokenfromtobeSenttoRest",t.mockUserId="0a088C17MOCKPUID@84df9e7f-e9f6-40af-b435-aaaaaaaaaaaa",t.mockDelay=100,t.mockDevMode=!0,t.mockSessionId="1234567890-mock-sess-ionId-bbbbbbbbbbb987654321",t.mockStorageUrl="https://maker-storage.com",t.cleanUpMockProviders=function(){n.setUserAccessInfo({currentUserToken:null,currentUserId:null,currentUserMlapiToken:null}),n.setAdminAccessToken(null),n.useLocalStorage(!1)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);t.id_first="test-script-first",t.id_second="test-script-second",t.xmlEmpty='<scriptIds xmlns="'+n.CXPSStrings.Namespace+'" id="'+n.CXPSStrings.ScriptIdsNodeId+'"></scriptIds>',t.xmlOneScript='<scriptIds xmlns="'+n.CXPSStrings.Namespace+'" id="'+n.CXPSStrings.ScriptIdsNodeId+'"><scriptId id="'+t.id_first+'"></scriptId></scriptIds>',t.xmlTwoScripts='<scriptIds xmlns="'+n.CXPSStrings.Namespace+'" id="'+n.CXPSStrings.ScriptIdsNodeId+'"><scriptId id="'+t.id_first+'"></scriptId><scriptId id="'+t.id_second+'"></scriptId></scriptIds>',t.xmlMalformed='<scriptIds xmlns="'+n.CXPSStrings.Namespace+'" id="'+n.CXPSStrings.ScriptIdsNodeId+'"><scriptId id="'+t.id_first+'"></scriptId><scriptId></scriptId></scriptIds>',t.mockRequestId="Request-uuid",t.mockTenantId="Tenant-guid"},function(e,t,r){"use strict";!function(){if(!/MSIE|Trident/.test(window.navigator.userAgent)){var e=r(0).setUserAccessInfo,t=r(0).setSessionId,n=r(6).getScripts,o=r(6).getSharedScript,i=r(6).getSharedScripts,c=r(42).getUserPermissions,s=r(0).setStorageEnvironmentOverride,a=r(0).useLocalStorage,u=r(6).saveScript;window.makerstorage={setUserAccessInfo:e,setSessionId:t,getScripts:n,getSharedScript:o,getSharedScripts:i,getUserPermissions:c,setStorageEnvironmentOverride:s,useLocalStorage:a,saveScript:u}}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o,i,c,s=r(8);t.setUserAccessInfo=function(e){c=e.currentUserId,n=e.currentUserToken,i=e.currentUserMlapiToken},t.setAdminAccessToken=function(e){o=e},t.getMlapiAccessToken=function(){if(!i)throw new Error("Access token not set.");return i},t.getAdminAccessToken=function(){if(!o)throw new Error("Admin access token not set.");return o},t.getAccessToken=function(){if(!n)throw new Error("Access token not set.");return n},t.getUserId=function(){if(s.inDevMode())return null;if(!c)throw new Error("User id not set.");return c}},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.setNodeFetch=function(e){n=!!e||null},t.usingNodeFetch=function(){return!!n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(8);t.setSessionId=function(e){n=e},t.getSessionId=function(){if(o.inDevMode())return null;if(!n)throw new Error("Session id not set.");return n}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(2);t.setStorageEnvironmentOverride=function(e){n=e},t.buildStorageUrl=function(){return(o.SERVICE_URLS[n]||o.SERVICE_URLS.prod).concat("/storage")},t.buildAdminUrl=function(){return(o.SERVICE_URLS[n]||o.SERVICE_URLS.prod).concat("/admin")}},function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r(20));t.createScript=function(){return{id:o.default(),name:"New Script"}}},function(e,t,r){var n=r(21),o=r(22);e.exports=function(e,t,r){var i=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var c=(e=e||{}).random||(e.rng||n)();if(c[6]=15&c[6]|64,c[8]=63&c[8]|128,t)for(var s=0;s<16;++s)t[i+s]=c[s];return t||o(c)}},function(e,t){var r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(r){var n=new Uint8Array(16);e.exports=function(){return r(n),n}}else{var o=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},function(e,t){for(var r=[],n=0;n<256;++n)r[n]=(n+256).toString(16).substr(1);e.exports=function(e,t){var n=t||0,o=r;return[o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],"-",o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]],o[e[n++]]].join("")}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=r(2);function i(e){var t=e.metadata;return{id:e.id,name:t.name,dateFirstPublished:t.dateFirstPublished*o.NUM_MILLISECONDS_PER_SECOND,dateLastPublished:t.dateLastPublished*o.NUM_MILLISECONDS_PER_SECOND,creatorId:t.creatorID}}t.convertResponseToScriptCoresV0=function(e){return e.map(i)},t.convertResponseToScriptV0=function(e){return n(n({},i(e)),{description:e.metadata.description,body:e.body})}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=r(2);function i(e){return{id:e.id,name:e.name,parameterInfo:e.parameterInfo,dateFirstPublished:e.dateFirstPublished*o.NUM_MILLISECONDS_PER_SECOND,dateLastPublished:e.dateLastPublished*o.NUM_MILLISECONDS_PER_SECOND,creatorId:e.owner,lastModifiedBy:e.lastModifiedBy}}t.convertResponseToScriptCoresV1=function(e){return e.map(i)},t.convertResponseToScriptV1=function(e){return n(n({},i(e)),{body:e.body,description:e.description})}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=r(2);function i(e,t){var r={id:e.id,shareId:e.shareId,name:e.name,parameterInfo:e.parameterInfo,dateFirstPublished:e.dateFirstPublished*o.NUM_MILLISECONDS_PER_SECOND,dateLastPublished:e.dateLastPublished*o.NUM_MILLISECONDS_PER_SECOND,creatorId:e.owner,lastModifiedBy:e.lastModifiedBy};if(t>=1){if(null==e.ownerDisplayName)throw new Error("Missing expected property in response");r.creatorDisplayName=e.ownerDisplayName}if(t>=3){if(null==e.isOwner)throw new Error("Missing expected property in response");r.isCreator=e.isOwner}return r}t.convertResponseToScriptCoresV2=function(e,t){return e.map((function(e){return i(e,t)}))},t.convertResponseToScriptV2=function(e,t){var r=n(n({},i(e,t)),{body:e.body,description:e.description});if(t>=2){if(null==e.apiInfo)throw new Error("Missing expected property in response");r.apiInfo=e.apiInfo}return r}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=r(5);t.addScriptToLocalStorage=function(e){var t=o.getScriptsMap(),r=Date.now(),i=n(n({},e),{dateFirstPublished:r,dateLastPublished:r});return t.set(e.id,i),o.updateLocalStorage(t),i}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5);t.getScriptFromLocalStorage=function(e){var t=n.getScriptsMap().get(e);if(!t)throw new Error("Script "+e+" does not exist!");return t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5);t.getScriptsFromLocalStorage=function(){var e=[];return n.getScriptsMap().forEach((function(t){return e.push({id:t.id,name:t.name,dateFirstPublished:t.dateFirstPublished,dateLastPublished:t.dateLastPublished,creatorId:t.creatorId})})),e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5);t.removeScriptFromLocalStorage=function(e){var t=n.getScriptsMap();t.has(e)&&t.delete(e)&&n.updateLocalStorage(t)}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o=r(5);t.updateScriptOnLocalStorage=function(e,t){var r=o.getScriptsMap();if(!r.has(e)||!r.get(e))throw new Error("Script "+e+" does not exist!");var i=r.get(e),c=n(n(n({},i),t),{dateLastPublished:Date.now()});return r.set(e,c),o.updateLocalStorage(r),c}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function c(e){try{a(n.next(e))}catch(e){i(e)}}function s(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(c,s)}a((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,n=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=c.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var c=i(r(32)),s=r(33),a=r(0);function u(e){return n(this,void 0,void 0,(function(){var t,r,n;return o(this,(function(o){switch(o.label){case 0:return e.ok?[3,2]:[4,e.json()];case 1:throw t=o.sent(),r=t.message,n=t.storageErrorCode,new s.StorageServiceError(r,e.status,n);case 2:return[2,e]}}))}))}t.makeHttpRequest=function(e,t,r,i){return n(this,void 0,void 0,(function(){var n,s,l,f;return o(this,(function(o){return n=r.customHeaders,s=r.requestBody,l={method:t},f={},n&&Object.keys(n).forEach((function(e){f[e]=n[e]})),i&&(f.Authorization="Bearer "+i),null!=s&&(f["Content-Type"]="application/json",l.body=JSON.stringify(s)),l.headers=f,a.usingNodeFetch()?[2,c.default(e,l).then(u)]:[2,fetch(e,l).then(u)]}))}))},t.handleResponse=u},function(e,t,r){"use strict";var n=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n)return n;throw new Error("unable to locate global object")}();e.exports=t=n.fetch,t.default=n.fetch.bind(n),t.Headers=n.Headers,t.Request=n.Request,t.Response=n.Response},function(e,t,r){"use strict";var n,o=this&&this.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(r,n,o){var i=e.call(this,r)||this;return i.status=n,i.errorCode=o,Object.setPrototypeOf(i,t.prototype),i}return o(t,e),t}(Error);t.StorageServiceError=i},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function c(e){try{a(n.next(e))}catch(e){i(e)}}function s(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(c,s)}a((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,n=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=c.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(9),c=r(0);t.getSharedScript=function(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){return[2,i.getScriptInternal(c.buildStorageUrl()+"/shared/"+e,t)]}))}))}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function c(e){try{a(n.next(e))}catch(e){i(e)}}function s(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(c,s)}a((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,n=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=c.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(10),c=r(0);t.getSharedScripts=function(e){return n(this,void 0,void 0,(function(){return o(this,(function(t){return[2,i.getScriptsInternal(c.buildStorageUrl()+"/shared",e)]}))}))}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function c(e){try{a(n.next(e))}catch(e){i(e)}}function s(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(c,s)}a((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,n=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=c.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(3),c=r(4),s=r(0),a=r(1);function u(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){return[2,a.makeDeleteRequest(e,s.getAccessToken(),{"x-ms-client-request-id":t,"X-UserSessionId":s.getSessionId()})]}))}))}t.removeScriptInternal=u,t.removeScript=function(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return s.inDevMode()?[4,i.pause(s.getDelay())]:[3,2];case 1:return r.sent(),[2,c.removeScriptFromLocalStorage(e)];case 2:return[2,u(s.buildStorageUrl()+"/"+e,t)]}}))}))}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function c(e){try{a(n.next(e))}catch(e){i(e)}}function s(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(c,s)}a((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,n=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=c.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(38),c=r(11),s=r(39);t.saveScript=function(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){if(!c.isScriptNameValid(e.name))throw new Error("Script name is invalid.");if(!c.isScriptDescriptionValid(e.description))throw new Error("Script description is invalid.");return[2,e.dateFirstPublished?s.updateScript(e,t):i.publishScript(e,t)]}))}))}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function c(e){try{a(n.next(e))}catch(e){i(e)}}function s(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(c,s)}a((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,n=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=c.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(7),c=r(3),s=r(4),a=r(0),u=r(1);function l(e,t,r){return n(this,void 0,void 0,(function(){var n,c,s;return o(this,(function(o){switch(o.label){case 0:return[4,u.makePostRequest(e,t,a.getAccessToken(),{"x-ms-client-request-id":r,"X-UserSessionId":a.getSessionId()})];case 1:return[4,(n=o.sent()).json()];case 2:return c=o.sent(),s=n.headers.get("Version"),[2,i.convertResponseJson(c,s)]}}))}))}t.publishScriptInternal=l,t.publishScript=function(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return a.inDevMode()?[4,c.pause(a.getDelay())]:[3,2];case 1:return r.sent(),[2,s.addScriptToLocalStorage(e)];case 2:return[2,l(a.buildStorageUrl(),e,t)]}}))}))}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function c(e){try{a(n.next(e))}catch(e){i(e)}}function s(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(c,s)}a((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,n=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=c.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},i=this&&this.__rest||function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r};Object.defineProperty(t,"__esModule",{value:!0});var c=r(7),s=r(3),a=r(4),u=r(0),l=r(1);function f(e,t,r){return n(this,void 0,void 0,(function(){var n,i,s;return o(this,(function(o){switch(o.label){case 0:return[4,l.makePutRequest(e,t,u.getAccessToken(),{"x-ms-client-request-id":r,"X-UserSessionId":u.getSessionId()})];case 1:return[4,(n=o.sent()).json()];case 2:return i=o.sent(),s=n.headers.get("Version"),[2,c.convertResponseJson(i,s)]}}))}))}t.updateScriptInternal=f,t.updateScript=function(e,t){return n(this,void 0,void 0,(function(){var r,n;return o(this,(function(o){switch(o.label){case 0:return r=e.id,e.dateFirstPublished,e.dateLastPublished,n=i(e,["id","dateFirstPublished","dateLastPublished"]),u.inDevMode()?[4,s.pause(u.getDelay())]:[3,2];case 1:return o.sent(),[2,a.updateScriptOnLocalStorage(r,n)];case 2:return[2,f(u.buildStorageUrl()+"/"+r,n,t)]}}))}))}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function c(e){try{a(n.next(e))}catch(e){i(e)}}function s(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(c,s)}a((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,n=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=c.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),c=r(1);t.shareScript=function(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return[4,c.makePutRequest(i.buildStorageUrl()+"/"+e+"/share",!0,i.getAccessToken(),{"x-ms-client-request-id":t,"X-UserSessionId":i.getSessionId()})];case 1:return[4,r.sent().text()];case 2:return[2,r.sent()]}}))}))}},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function c(e){try{a(n.next(e))}catch(e){i(e)}}function s(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(c,s)}a((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,n=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=c.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(0),c=r(1);t.unshareScript=function(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){return[2,c.makePutRequest(i.buildStorageUrl()+"/"+e+"/share",!1,i.getAccessToken(),{"x-ms-client-request-id":t,"X-UserSessionId":i.getSessionId()})]}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(43);t.getUserPermissions=n.getUserPermissions},function(e,t,r){"use strict";var n=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(o,i){function c(e){try{a(n.next(e))}catch(e){i(e)}}function s(e){try{a(n.throw(e))}catch(e){i(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(c,s)}a((n=n.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var r,n,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,n=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!(o=c.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var i=r(44),c=r(0),s=r(3),a=r(1);function u(e,t){return n(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return[4,a.makeGetRequest(e,c.getAccessToken(),{"x-ms-client-request-id":t,"X-UserSessionId":c.getSessionId()})];case 1:return[4,r.sent().json()];case 2:return[2,r.sent()]}}))}))}t.getUserPermissionsInternal=u,t.getUserPermissions=function(e){return n(this,void 0,void 0,(function(){return o(this,(function(t){switch(t.label){case 0:return c.inDevMode()?[4,s.pause(c.getDelay())]:[3,2];case 1:return t.sent(),[2,{UserId:i.mockUserId,OfficeScriptingEnabled:!0}];case 2:return[2,u(c.buildAdminUrl()+"/me/policy",e)]}}))}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(45);t.getMockContext=n.getMockContext;var o=r(46);t.getMockCustomHeaders=o.getMockCustomHeaders;var i=r(47);t.getMockScriptFromService_Unversioned=i.getMockScriptFromService_Unversioned,t.getMockScriptFromServiceV1=i.getMockScriptFromServiceV1,t.getMockScriptFromServiceV2=i.getMockScriptFromServiceV2,t.getMockScriptFromServiceV2_1=i.getMockScriptFromServiceV2_1,t.getMockScriptFromServiceV2_1Future=i.getMockScriptFromServiceV2_1Future,t.getMockScriptFromServiceV2_2=i.getMockScriptFromServiceV2_2,t.getMockScriptFromServiceV2_3=i.getMockScriptFromServiceV2_3;var c=r(13);t.id_first=c.id_first,t.id_second=c.id_second,t.xmlEmpty=c.xmlEmpty,t.xmlOneScript=c.xmlOneScript,t.xmlTwoScripts=c.xmlTwoScripts,t.xmlMalformed=c.xmlMalformed,t.mockRequestId=c.mockRequestId,t.mockTenantId=c.mockTenantId;var s=r(12);t.cleanUpMockProviders=s.cleanUpMockProviders,t.mockAccessToken=s.mockAccessToken,t.mockMlapiAccessToken=s.mockMlapiAccessToken,t.mockUserId=s.mockUserId,t.mockDelay=s.mockDelay,t.mockDevMode=s.mockDevMode,t.mockSessionId=s.mockSessionId,t.mockStorageUrl=s.mockStorageUrl},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMockContext=function(e){return{workbook:{customXmlParts:{add:jest.fn(),getByNamespace:function(){return{getCount:function(){return{value:e}},getOnlyItem:jest.fn((function(){return{getXml:jest.fn((function(){return{value:""}})),setXml:jest.fn()}}))}}}},sync:jest.fn()}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(12),o=r(13);t.getMockCustomHeaders=function(){return{"x-ms-client-request-id":o.mockRequestId,"X-UserSessionId":n.mockSessionId}}},function(e,t,r){"use strict";var n=this&&this.__assign||function(){return(n=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function o(){return{id:"testId",shareId:"testShareId",dateFirstPublished:1,dateLastPublished:2,name:"mock script name",description:"mock description",parameterInfo:"mock paramter info",owner:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",ownerDisplayName:"Test Owner",tenantID:"12345678-9bf5-419f-9c0e-02a256088ecf",body:"// <code>",lastModifiedBy:"12345678-cb6d-4e00-88fc-8bc1e1cf1417"}}Object.defineProperty(t,"__esModule",{value:!0}),t.getMockScriptFromService_Unversioned=function(){return{id:"testId",metadata:{dateFirstPublished:1,dateLastPublished:2,name:"mock script name",description:"mock description",creatorID:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",tenantID:"12345678-9bf5-419f-9c0e-02a256088ecf"},body:"// <code>"}},t.getMockScriptFromServiceV1=function(){return{id:"testId",dateFirstPublished:1,dateLastPublished:2,name:"mock script name",description:"mock description",parameterInfo:"mock paramter info",owner:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",tenantID:"12345678-9bf5-419f-9c0e-02a256088ecf",body:"// <code>",lastModifiedBy:"12345678-cb6d-4e00-88fc-8bc1e1cf1417"}},t.getMockScriptFromServiceV2=function(){return{id:"testId",shareId:"testShareId",dateFirstPublished:1,dateLastPublished:2,name:"mock script name",description:"mock description",parameterInfo:"mock paramter info",owner:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",tenantID:"12345678-9bf5-419f-9c0e-02a256088ecf",body:"// <code>",lastModifiedBy:"12345678-cb6d-4e00-88fc-8bc1e1cf1417"}},t.getMockScriptFromServiceV2_1=o,t.getMockScriptFromServiceV2_1Future=function(){return n(n({},{id:"testId",shareId:"testShareId",dateFirstPublished:1,dateLastPublished:2,name:"mock script name",description:"mock description",parameterInfo:"mock paramter info",owner:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",ownerDisplayName:"Test Owner",tenantID:"12345678-9bf5-419f-9c0e-02a256088ecf",body:"// <code>",lastModifiedBy:"12345678-cb6d-4e00-88fc-8bc1e1cf1417"}),{futureProperty:"12345678-cb6d-4e00-88fc-8bc1e1cf1417"})},t.getMockScriptFromServiceV2_2=function(){return{id:"testId",shareId:"testShareId",dateFirstPublished:1,dateLastPublished:2,name:"mock script name",description:"mock description",apiInfo:"batch",parameterInfo:"mock paramter info",owner:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",ownerDisplayName:"Test Owner",tenantID:"12345678-9bf5-419f-9c0e-02a256088ecf",body:"// <code>",lastModifiedBy:"12345678-cb6d-4e00-88fc-8bc1e1cf1417"}},t.getMockScriptFromServiceV2_3=function(){return{id:"testId",shareId:"testShareId",dateFirstPublished:1,dateLastPublished:2,name:"mock script name",description:"mock description",apiInfo:"batch",parameterInfo:"mock paramter info",owner:"12345678-cb6d-4e00-88fc-8bc1e1cf1417",ownerDisplayName:"Test Owner",isOwner:!0,tenantID:"12345678-9bf5-419f-9c0e-02a256088ecf",body:"// <code>",lastModifiedBy:"12345678-cb6d-4e00-88fc-8bc1e1cf1417"}}}]);