typeof IEnumerable=="undefined"&&(IEnumerable=function(){},IEnumerable.registerInterface("IEnumerable"));typeof IEnumerator=="undefined"&&(IEnumerator=function(){},IEnumerator.registerInterface("IEnumerator"));typeof Sys=="undefined"&&Type.registerNamespace("Sys");typeof Sys.IEnumerable$1=="undefined"&&(Sys.IEnumerable$1=function(){},Sys.IEnumerable$1.registerInterface("Sys.IEnumerable$1"));typeof Sys.IEnumerator$1=="undefined"&&(Sys.IEnumerator$1=function(){},Sys.IEnumerator$1.registerInterface("Sys.IEnumerator$1"));Type.registerNamespace("Common.App.Enrichment");Common.App.Enrichment.m=function(){};Common.App.Enrichment.m.registerInterface("Common.App.Enrichment.m");Common.App.Enrichment.l=function(){};Common.App.Enrichment.l.registerInterface("Common.App.Enrichment.l");Common.App.Enrichment.k=function(){};Common.App.Enrichment.k.registerInterface("Common.App.Enrichment.k");Common.App.Enrichment.n=function(){this.requestId=requestId;this.cellId=cellId};Common.App.Enrichment.n.prototype={requestId:null,cellId:null};Common.App.Enrichment.h=function(){this.messageType=type};Common.App.Enrichment.h.prototype={messageType:0};Common.App.Enrichment.b=function(){this.messageContent=this.$$gta["Common.App.Enrichment.b"].T===Number||Type.isEnum(this.$$gta["Common.App.Enrichment.b"].T)?0:this.$$gta["Common.App.Enrichment.b"].T===Boolean?!1:null;Common.App.Enrichment.b.$$(this.$$gta["Common.App.Enrichment.b"].T).initializeBase(this,[type]);this.messageContent=content};Common.App.Enrichment.b.$$=function(n){var u=Common.App.Enrichment.__tc=Common.App.Enrichment.__tc||{},t="b$"+n.getName().replace(/\./g,"_"),i,o,s,f,e,r;if(!u[t]){i=u[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];Common.App.Enrichment.b.apply(this,t)};o=Common.App.Enrichment.h;i.registerClass("Common.App.Enrichment.__tc."+t,o);s={"Common.App.Enrichment.b":{T:n},ctor:Common.App.Enrichment.b};i.prototype.$$gta=s;f=Common.App.Enrichment.b.prototype;for(e in f)r={key:e,value:f[e]},"constructor"!==r.key&&(i.prototype[r.key]=r.value)}return u[t]};Common.App.Enrichment.j=function(){};Common.App.Enrichment.j.prototype={Query:null,TelemetryJson:null};Common.App.Enrichment.i=function(n){this.messageType=n};Common.App.Enrichment.i.prototype={messageType:0};Common.App.Enrichment.c=function(n,t){this.messageContent=this.$$gta["Common.App.Enrichment.c"].T===Number||Type.isEnum(this.$$gta["Common.App.Enrichment.c"].T)?0:this.$$gta["Common.App.Enrichment.c"].T===Boolean?!1:null;Common.App.Enrichment.c.$$(this.$$gta["Common.App.Enrichment.c"].T).initializeBase(this,[n]);this.messageContent=t};Common.App.Enrichment.c.$$=function(n){var u=Common.App.Enrichment.__tc=Common.App.Enrichment.__tc||{},t="c$"+n.getName().replace(/\./g,"_"),i,o,s,f,e,r;if(!u[t]){i=u[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];Common.App.Enrichment.c.apply(this,t)};o=Common.App.Enrichment.i;i.registerClass("Common.App.Enrichment.__tc."+t,o);s={"Common.App.Enrichment.c":{T:n},ctor:Common.App.Enrichment.c};i.prototype.$$gta=s;f=Common.App.Enrichment.c.prototype;for(e in f)r={key:e,value:f[e]},"constructor"!==r.key&&(i.prototype[r.key]=r.value)}return u[t]};Common.App.Enrichment.d=function(n,t,i){Common.App.Enrichment.d.$$(this.$$gta["Common.App.Enrichment.d"].T).initializeBase(this,[n,t]);this.telemetryJson=i};Common.App.Enrichment.d.$$=function(n){var u=Common.App.Enrichment.__tc=Common.App.Enrichment.__tc||{},t="d$"+n.getName().replace(/\./g,"_"),i,f,e,o,s,h,c,l,r;if(!u[t]){i=u[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];Common.App.Enrichment.d.apply(this,t)};f=Common.App.Enrichment.c.$$(n);i.registerClass("Common.App.Enrichment.__tc."+t,f);e={"Common.App.Enrichment.d":{T:n},ctor:Common.App.Enrichment.d};o=f.prototype.$$gta;for(s in o)h={key:s,value:o[s]},e[h.key]=h.value;i.prototype.$$gta=e;c=Common.App.Enrichment.d.prototype;for(l in c)r={key:l,value:c[l]},"constructor"!==r.key&&(i.prototype[r.key]=r.value)}return u[t]};Common.App.Enrichment.d.prototype={telemetryJson:null};Common.App.Enrichment.f=function(){};Common.App.Enrichment.f.prototype={keyCode:0};Common.App.Enrichment.e=function(){};Common.App.Enrichment.e.prototype={applicationName:null,applicationVersion:null,anid:null,sessionId:null,appCorrelationId:null,market:null,themeId:0,featuresBitMask:0,uiLanguage:null,disambiguationJson:null};Common.App.Enrichment.a=function(n,t,i,r,u){this.r=Function.createDelegate(this,this.O);this.q=Function.createDelegate(this,this.M);this.o=Function.createDelegate(this,this.K);this.p=Function.createDelegate(this,this.L);this.w=Function.createDelegate(this,this.D);this.n=Function.createDelegate(this,this.J);this.g=n;this.y=t;this.x=i;this.j=r;this.s=u;this.i=Common.h.b(27,0)};Common.App.Enrichment.a.a=function(n,t,i,r,u,f,e,o){var h,c,s;return Common.c.i()?(c=String.format("{0} {1} {2}",f?"Shift":"",e?"Control":"",o?"Alt":""),c.trim(),h=document.createEvent("KeyboardEvent"),h.initKeyboardEvent(n,r,u,window.self,t,0,c,!1,"en-US")):(s={},s.keyCode=i,s.ctrlKey=e,s.shiftKey=f,s.altKey=o,s.bubbles=r,s.cancelable=u,h=new KeyboardEvent(n,s)),h};Common.App.Enrichment.a.prototype={g:null,y:null,e:null,d:null,x:null,j:null,s:null,t:null,u:null,k:null,h:null,i:null,v:!1,A:function(){return!0},l:function(){return Common.a.a.i.EnrichmentPaneUrl},dispose:function(){this.A()&&this.h&&this.g.b("click",this.h,this.n);this.h=null;this.d&&(this.Q(),this.d.parentNode.removeChild(this.d),this.d=null);var n=this.j.a("EnrichmentPaneId");n.a(this.i)},b:function(n,t,i){this.e=n;this.v||(this.k=this.E(),this.z().appendChild(this.k),this.N(),this.s.a(1520278933,2147483648,this.w),this.P(),this.v=!0);this.d.src=this.l()&&this.l().length?this.l()+"?culture="+t.market+"&appName="+t.applicationName+"&themeId="+t.themeId+"&featuresBitMask="+t.featuresBitMask:"about:blank";this.t=t;this.u=i;this.C()},c:function(n,t){var i=new(Common.App.Enrichment.d.$$(String))(2,n,t);this.m(i)},P:function(){var n=this.j.a("EnrichmentPaneId");n.d="main";this.g.d("EnrichmentPaneId",this.k,!1);n.b(this.i,1520278933)},O:function(){if(this.d){Common.n.b(this.d.contentWindow);var n=new(Common.App.Enrichment.d.$$(String))(4,null,null);this.m(n)}},J:function(){return this.a(),this.e&&this.e.f(),!0},E:function(){var n=CommonUI.a.a("div","EnrichmentPaneId","EnrichmentPane");return this.A()&&n.appendChild(this.F()),this.I(n),n},F:function(){var t=CommonUI.a.b("div","EnrichmentPaneHeaderId","EnrichmentPaneHeader"),i=CommonUI.a.b("div","EnrichmentPaneTitleId","cui-taskPaneTitle EnrichmentPaneTitle"),n;return i.innerText=$a.Y,i.title=$a.Y,n=CommonUI.e.a("CloseEnrichmentPane","EnrichmentPaneCloseButton",$a.c,"ClosePaneGlyph_16x16x32",!1),this.g.a("click",n,this.n),t.appendChild(i),t.appendChild(n),this.h=n,t},I:function(n){this.d=CommonUI.a.b("iframe","","EnrichmentFrame");n.appendChild(this.d);this.d.id="EnrichmentContentFrame"},N:function(){Common.j.a(this.d,"load",this.p);Common.j.a(this.d,"error",this.o);$addHandler(window,"message",this.q)},Q:function(){Common.j.c(this.d,"load",this.p);Common.j.c(this.d,"error",this.o);$removeHandler(window,"message",this.q)},G:function(){this.d.src="about:blank"},a:function(){this.B();this.G()},D:function(n,t,i){return i!==1&&this.a(),32},L:function(){},K:function(){},M:function(n){var r=n.rawEvent,t,u,f,e,o,i,s,h,c,l;if(!this.d||this.d.src.indexOf(r.origin)!==-1){try{t=JSON.parse(r.data)}catch(p){return}if(!CommandUI.a.a(t.messageType)){u=window.g_badCastCallback;window.g_badCastCallback=null;switch(t.messageType){case 2:this.m(new(Common.App.Enrichment.d.$$(String))(1,JSON.stringify(this.t),this.u));break;case 1:this.m(new(Common.App.Enrichment.c.$$(String))(0,this.H()));break;case 3:f=t;this.e&&this.e.i(f.messageContent);break;case 5:e=t;this.e&&this.e.e(e.messageContent);break;case 8:o=t;this.e&&(i=JSON.parse(o.messageContent),this.e.g(i.Query,i.TelemetryJson));break;case 6:this.e&&this.e.b();break;case 11:var a=t,v=JSON.parse(a.messageContent),y=Common.App.Enrichment.a.a("keydown","f6",117,!0,!1,v,!0,!1,!1);this.d&&this.d.dispatchEvent(y);break;case 12:s=t;h=JSON.parse(s.messageContent);h.keyCode===27&&(c=Common.App.Enrichment.a.a("keydown","esc",27,!0,!1,!1,!1,!1,!1),this.d&&this.d.dispatchEvent(c));break;case 13:l=t;this.e&&this.e.h(l.messageContent)}window.g_badCastCallback=u}}},H:function(){return JSON.stringify([2,1,3,5,8,6])},m:function(n){var t=JSON.stringify(n);this.d.contentWindow.postMessage(t,Common.k.g(this.l()))}};Common.App.Enrichment.g=function(n){this.k=n};Common.App.Enrichment.g.prototype={k:null,j:null,d:function(n,t,i){this.j=n;this.k&&this.k.b(this,t,i)},a:function(n,t){this.k&&this.k.c(n,t)},c:function(){this.k&&this.k.a()},dispose:function(){this.k&&(this.k.dispose(),this.k=null)},i:function(n){return this.j?this.j.k(n):!1},g:function(n,t){this.j&&this.j.i(n,t)},e:function(n){return this.j?this.j.g(n):!1},f:function(){this.j&&this.j.h()},b:function(){this.j&&this.j.f()},h:function(n){this.j&&this.j.j(n)}};Common.App.Enrichment.h.registerClass("Common.App.Enrichment.h");Common.App.Enrichment.i.registerClass("Common.App.Enrichment.i");Common.App.Enrichment.e.registerClass("Common.App.Enrichment.e");Common.App.Enrichment.a.registerClass("Common.App.Enrichment.a",null,Common.App.Enrichment.l,Sys.IDisposable);Common.App.Enrichment.g.registerClass("Common.App.Enrichment.g",null,Common.App.Enrichment.k,Sys.IDisposable);Type.registerNamespace("_Ewa");_Ewa.VN=function(){};_Ewa.De=function(n,t){this.b=t;this.a=n};_Ewa.De.prototype={b:null,a:null,w:function(){return!1},u:function(n,t,i){var u=$$sc.a.a(Boolean,!0),f=t.a,r;switch(f){case-1203788282:if(r=this.c(i.MenuItemId.toString()),!r){Diag.a.a(37340321,0,15,"Unknown MenuItemIdKey triggered RibbonCommand.ConvertToLinkedEntity, SourceKey: {0}",r);break}this.a.q(r);break;case 311599363:this.a.o();break;case 439914789:this.a.e();break;case 2127195269:this.a.w();break;case-1662108744:this.a.x(0);break;case 1266950951:this.a.v(!0);break;case 49813714:this.a.r();break;default:u=_Ewa.K.a(f)}return u},t:function(n,t){switch(t.a){case-1203788282:case 439914789:case 2127195269:case 49813714:return this.b.a(169);case-1662108744:return this.b.a(883);case 311599363:case 1266950951:return!0;default:return!1}},v:function(n,t,i){return t==="PopulateConvertToLinkedEntityMenu"&&this.b.a(169)?this.a.z(n,t,i):!1},c:function(n){var t=0,i,r;return(t=parseInt(n),t>0)?t:(Diag.a.a(593769358,0,50,"ConvertToLinkedEntityCommandHandler.GetLinkedEntityDomain: Using fallback for menuItemKey: {0}",n),i=_Ewa.ClientStringManager.a().a(1508),r=_Ewa.ClientStringManager.a().a(1509),n===this.a.b()||n===this.a.a())?parseInt(n):_Ewa.e.c(n,i,!0)?parseInt(this.a.a()):_Ewa.e.c(n,r,!0)?parseInt(this.a.b()):t}};_Ewa.sE=function(n){_Ewa.sE.initializeBase(this,[n])};_Ewa.sE.a=function(n){_Ewa.Z.a(273,new _Ewa.sE(n))};_Ewa.sE.prototype={l:function(){var n=this;_Ewa.fn.a(_Ewa.fi,this.h,271,272,function(t){n.k([new _Ewa.De(t,n.h)],null)})}};_Ewa.Df=function(n,t,i,r){this.u=Function.createDelegate(this,this.G);this.i=Function.createDelegate(this,this.P);this.j=Function.createDelegate(this,this.I);this.v=Function.createDelegate(this,this.H);this.w=Function.createDelegate(this,this.K);this.l=Function.createDelegate(this,this.M);this.x=Function.createDelegate(this,this.O);this.k=Function.createDelegate(this,this.J);this.m=Function.createDelegate(this,this.N);this.a=n;this.b=_Ewa.b.a(this.a);this.b.a().k(this.m);this.b.t(this.k);this.o=r;i.f(_Ewa.oU,t);var u=new _Ewa.Dh(t);this.g=new _Ewa.Di(u)};_Ewa.Df.prototype={a:null,n:!1,c:!1,d:!0,p:!1,e:null,h:0,o:null,b:null,g:null,dispose:function(){this.a&&(this.b.a().l(this.m),this.b.w(this.k))},R:function(n){var i=_Ewa.h.c(this.b.a().b(),this.a),t=this,r=function(r,u){return _Ewa.en.m(t.a.d().a(),i,n,_Ewa.n.a(r,t.x),u,null,null)},u=this;return _Ewa.L.a(this.a.g(),r,function(n){return new _Ewa.G(109,0,n,0,null)},null),!0},Q:function(n,t){Diag.a.a(38846755,0,50,"ConvertToLinkedEntityManager:SearchEntity() - Search attempted with TelemetryJSON: {0}",t);var r=_Ewa.h.c(this.b.a().b(),this.a),i=this,u=function(t,u){return _Ewa.en.l(i.a.d().a(),r,n,_Ewa.n.a(t,i.l),u,null,null)},f=this;_Ewa.L.a(this.a.g(),u,function(n){return new _Ewa.G(110,0,n,16,null)},null);return},F:function(n){var t=_Ewa.h.c(this.b.a().b(),this.a);!t;this.d=!1;var i=this,r=function(r,u){return _Ewa.en.i(i.a.d().a(),t,n,_Ewa.n.a(r,i.w),u,null,null)},u=this;return _Ewa.L.a(this.a.g(),r,function(n){return new _Ewa.G(111,0,n,16,null)},null),!0},L:function(){this.c=!1;this.n=!0;return},z:function(){var n=this.t();if(n){var t=this,i=function(i,r){return _Ewa.en.b(t.a.d().a(),n,_Ewa.n.a(i,t.l),r,null,null)},r=this;_Ewa.L.a(this.a.g(),i,function(n){return new _Ewa.G(112,0,n,16,null)},null);return}},J:function(){(this.d||this.c)&&(this.a.a(883)&&this.h!==1||this.q(!1))},P:function(){Diag.a.a(39081763,0,15,"Session ID changed while ambiguous linked entities are present")},q:function(n){this.E(n)},C:function(){var n,t;if(Diag.a.a(36975685,0,50,"ConvertToLinkedEntityManager:LaunchDisambiguationPaneForSearch() - Launch Disambiguation Pane For Search attempted"),n=this.t(),n){t=null;this.a.a(883)&&(t=1);var i=this,r=function(r,u){return _Ewa.en.a(i.a.d().a(),n,!0,_Ewa.n.a(r,i.v),u,t,null)},u=this;_Ewa.L.a(this.a.g(),r,function(n){return new _Ewa.G(113,0,n,16,null)},null)}},D:function(n){var t=null;this.a.a(883)&&(t=2);var i=this,r=function(r,u){return _Ewa.en.e(i.a.d().a(),n,_Ewa.n.a(r,i.j),u,t,null)},u=this;_Ewa.L.a(this.a.g(),r,function(n){return new _Ewa.G(235,0,n,16,null)},null)},G:function(n){var t,i,u,r;if(_Ewa.g.c(n.Errors)){t=_Ewa.g.a(n.Errors,",");_Ewa.e.c(t,"OperationSucceededWithAlert",!1)?Diag.a.a(38541457,0,50,"Convert to Linked Entity failed with an alert"):Diag.a.a(36975687,0,10,"Failed to Convert to Linked Entity. errors: {0}",t);return}n.Result&&(!n.WorkbookMetadataResult.Metadata&&this.p&&(i=_Ewa.k.b(_Ewa.cM,this.a.b(),5,4),u=this,_Ewa.f.cw(i,function(){i.a().g()},this.a.i(),3)),this.a.c().h(this.i),this.a.c().g(this.i),r=n.Result,this.e=r.SkydanceFeatureBitmask,this.s(r))},N:function(){(this.d||this.c)&&this.q(!1)},I:function(n,t){var i,r;if(_Ewa.g.c(n.Errors)){Diag.a.a(36975688,0,10,"Failed to retrieve disambiguation data for Ambiguous Linked Entity. errors: {0}",_Ewa.g.a(n.Errors,","));return}if(n.Result){if(i=n.Result,!i.DisambiguationJson){Diag.a.a(41552074,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataSucceeded: Json is null");return}this.y(t);this.e=i.SkydanceFeatureBitmask;r=i.DisambiguationJson;this.r(r)}return},H:function(n,t){var i,r;if(_Ewa.g.c(n.Errors)){Diag.a.a(36975689,0,10,"Failed to retrieve disambiguation data for search. errors: {0}",_Ewa.g.a(n.Errors,","));return}if(n.Result){if(i=n.Result,!i.DisambiguationJson){Diag.a.a(41552075,0,10,"ConvertToLinkedEntityDisambiguationPane:OnGetDisambiguationDataForSearchSucceeded: Json is null");return}this.y(t);this.e=i.SkydanceFeatureBitmask;r=i.DisambiguationJson;this.r(r)}return},y:function(n){if(n&&this.a.a(883)){var t=n;t&&t!==this.h&&this.f();this.h=t}},r:function(n){if(this.c)this.g.a(n,null);else{var t=3;this.e!=null?t=this.e:Diag.a.b(40511299,0,!1,"SkydanceFeatureBitmask was not set");this.g.d(this.o,this.B(n,t),null);this.c=!0}return},f:function(){this.c&&(this.g.c(),this.c=!1,this.h=0);return},K:function(n){if(_Ewa.g.c(n.Errors)){Diag.a.a(36975690,0,10,"Failed to move to the next ambiguous Linked Entity. errors: {0}",_Ewa.g.a(n.Errors,","));this.d=!0;return}if(n.Result){var t=n.Result;this.e=t.SkydanceFeatureBitmask;this.s(t)}return},s:function(n){var t=n.Row+1,i=n.Column+1,u=n.DisambiguationJson,r;if(t<0||i<0){this.f();this.a.c().h(this.i);return}r=new _Ewa.o(t,i,t,i,!0,!1);this.b.a().f(r,r,60,0,!0,"",!1,!0,!0);this.d=!0;this.r(u)},B:function(n,t){var i=new Common.App.Enrichment.e,f,r,u;return i.applicationVersion=Common.a.n,i.applicationName="ExcelWac",f="00000000-0000-0000-0000-000000000000",i.anid=f,i.sessionId=Common.a.k,i.appCorrelationId=Common.F.a().a,r=Common.d.b(Common.a.l),u=r?r.a:null,i.uiLanguage=u,i.market=this.A(u),i.themeId=0,i.disambiguationJson=n,t<=2147483647?i.featuresBitMask=t:Diag.a.a(40511300,0,10,"SkydanceFeaturesBitmask is too large for EnrichmentMessageContentAppProperties"),i},A:function(n){var t=n.split("-");return t[t.length-1]},E:function(n){var f=this.a.j(),t,r,i;if(!f||!this.t()){this.f();return}if(t=this.b.a().b(),_Ewa.b.a(this.a).g().l(t)){if(this.n&&!n)return;n&&(this.d=!0);r=_Ewa.h.c(t,this.a);i=null;this.a.a(883)&&(i=1);var u=this,e=function(n,t){return _Ewa.en.a(u.a.d().a(),r,!1,_Ewa.n.a(n,u.j),t,i,null)},o=this;_Ewa.L.a(this.a.g(),e,function(n){return new _Ewa.G(114,0,n,16,null)},null)}else this.f();return},O:function(n){if(_Ewa.g.c(n.Errors)&&Diag.a.a(36975691,0,10,"Failed to select Linked Entity for Disambiguation.. errors: {0}",_Ewa.g.a(n.Errors,",")),n.Result){var t=n.Result;this.s(t)}else this.f();return},M:function(n){if(_Ewa.g.c(n.Errors)){Diag.a.a(36975692,0,15,"Failed to retrieve data for searching in Disambiguation Pane.  Error id names: {0}",_Ewa.g.a(n.Errors,","));return}if(n.Result){var t=n.Result;this.g.a(t,null)}else this.f();return},t:function(){var n=this.b.a();return(this.a.a(476)?n.d().d():n.a().j())?_Ewa.h.c(n.b(),this.a):null}};_Ewa.sF=function(n,t,i,r){this.bf=Function.createDelegate(this,this.bx);this.bg=Function.createDelegate(this,this.by);this.T=Function.createDelegate(this,this.bt);this.bh=Function.createDelegate(this,this.bA);this.bi=Function.createDelegate(this,this.bB);this.bj=Function.createDelegate(this,this.bC);this.bk=Function.createDelegate(this,this.bD);this.bl=Function.createDelegate(this,this.bE);this.U=Function.createDelegate(this,this.bz);this.bb=Function.createDelegate(this,this.bF);this.bc=-1;this.E=n;this.I=[];this.G=_Ewa.b.a(this.E);this.S=this.bc;this.H=new($$sc.r.$$(_Ewa.zM));this.bd=this.E.m()+"Ribbon.Data.LinkedEntity";this.ba=new _Ewa.Dg(t,n);this.F=new _Ewa.Df(n,i,r,this);n.b().b(_Ewa.fi,271,this);this.E.a(597)&&this.E.c().t(this.bb);this.E.a(169)&&this.E.a(179)&&(this.bs()||this.G.t(this.U));this.Y=this.E.a(710);this.Y&&(this.M={})};_Ewa.sF.a=function(n,t,i){var r=String.format('<span class="cui-img-32by32 cui-img-cont-float"><IMG class="{0}" src="{1}" alt="{2}" align="middle"><\/span>',n,_Ewa.r.a(11),i),u=String.format('<div class="cui-row-onerow"><p class="cui-ctl-mediumlabel leg-gallerybuttonlabel" align="middle">{0}<\/p><\/div>',t);return String.format('<div mscui:controltype="GalleryButton" class="leg-gallerybutton">{0}{1}<\/div>',r,u)};_Ewa.sF.prototype={E:null,ba:null,I:null,F:null,Z:null,P:null,J:0,Y:!1,M:null,G:null,X:null,bn:2,W:null,S:0,Q:8,bo:2e3,bd:null,N:null,a:function(){return this.N},O:null,b:function(){return this.O},bv:function(){return _Ewa.e.a(this.W)&&(this.W=_Ewa.ClientStringManager.a().a(1507)),this.W},H:null,L:null,V:0,bm:5,R:3e4,be:!1,K:null,dispose:function(){this.E.a(597)&&this.E.c().v(this.bb);!this.K&&this.E.a(169)&&this.E.a(179)&&this.G.w(this.U);this.F&&this.F.dispose();System.a.a(this.L)},k:function(n){return this.F?this.F.R(n):!1},i:function(n,t){this.F&&this.F.Q(n,t)},g:function(n){return this.F?this.F.F(n):!1},h:function(){this.F&&this.F.L()},f:function(){this.F&&this.F.z()},j:function(){this.F},bF:function(){this.bI()},q:function(n){var f,i,e,t;if(Diag.a.a(34415004,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - conversion attempted  [ServiceEndpoint: {0}].",n),!this.G){Diag.a.b(34415005,0,!1,"grid view should not be null");return}this.bG(n);var r=this.G.a().a(),o=this.G.Q(),u=r.o(o);if(u){if(f=this.G.g().x(u),f){if(Diag.a.a(42467672,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - tried to convert an empty range"),_Ewa.w.a().j()&&this.E.a(564)){if(_Ewa.w.a().a())i="[data-unique-id=LinkedEntity]";else if(i=document.getElementById(this.bd),!i){Diag.a.b(42467673,0,!1,"Could not get multi-line ribbon anchor DOM element for the linked entity blank cell convert teaching callout.");return}e=new _Ewa.R(-847286761,_Ewa.D.a,this.E.s(),0,"Help");t={InputMethod:_Ewa.D.a};t.CalloutType=1;t.Target=i;t.RibbonButtonLabel=this.c(n.toString());t.ExampleEntities=this.bu(n.toString());this.E.h().b(e,t,null);return}Diag.a.a(42764317,0,50,"ConvertToLinkedEntityManager:ConvertToLinkedEntity() - Attempted to convert a blank range, teaching callout not enabled")}this.p(n,!1,r)}},bE:function(){if(this.E.isChangeGateEnabled("OfficeVSO:3843098_AnnounceLinkedEntityConversion")){var n=this;this.E.b().c(_Ewa.cE,211,function(n){n.a(_Ewa.ClientStringManager.a().a(1518))})}},r:function(){this.K&&this.K.t()},y:function(){var n=this,t=function(t,i){return _Ewa.en.j(n.E.d().a(),n.E.j().e(),t,i,null,null)},i=this;_Ewa.L.a(this.E.g(),t,function(n){return new _Ewa.bd(231,0,n,16,null)},null)},p:function(n,t,i){var e=_Ewa.h.d(i,this.E),f=null,r,u,o,s;this.Y&&this.H.a(n).Name==="Power BI"&&(this.M&&this.M.length>0?f=this.M[0]:Diag.a.a(594613853,0,100,"ConvertToLinkedEntityManager:ConvertRangeToLinkedEntity() - Attempted to convert to PowerBI, but there aren't any datasets"));r=this;u=function(i,u){return _Ewa.en.d(r.E.d().a(),e,n,t,JSON.stringify(f),_Ewa.n.a(i,r.bl,r.F.u),u,null,null)};this.E.isChangeGateEnabled("OfficeVSO:3989117_ConvertToLinkedEntityBlocking")?(o=this,_Ewa.L.a(this.E.g(),u,function(n){return new _Ewa.G(115,0,n,0,null)},null)):(s=this,_Ewa.L.a(this.E.g(),u,function(n){return new _Ewa.bd(115,0,n,0,null)},null))},o:function(){if(Diag.a.a(34719501,0,50,"ConvertToLinkedEntityManager:ConvertLinkedEntityToText() - conversion attempted"),!this.G){Diag.a.b(34719502,0,!1,"grid view should not be null");return}var n=_Ewa.h.d(this.G.a().a(),this.E),t=this,i=function(i,r){return _Ewa.en.c(t.E.d().a(),n,i,r,null,null)},r=this;_Ewa.L.a(this.E.g(),i,function(n){return new _Ewa.G(116,0,n,0,null)},null)},e:function(){var n;if(Diag.a.a(36234048,0,50,"ConvertToLinkedEntityManager:RefreshLinkedEntities() - refresh attempted"),n=_Ewa.b.a(this.E),!n){Diag.a.b(36234049,0,!1,"grid view should not be null");return}var t=_Ewa.h.c(n.a().b(),this.E),i=this,r=function(n,r){return _Ewa.en.k(i.E.d().a(),t,n,r,null,null)},u=this;_Ewa.L.a(this.E.g(),r,function(n){return new _Ewa.G(117,0,n,16,null)},null)},C:function(){return this.br(this.N)},B:function(){return this.br(this.O)},br:function(n){try{if(this.J===2&&n)return!this.H.a(parseInt(n))}catch(t){Diag.a.a(595068756,0,10,"ConvertToLinkedEntityManager:ShouldHideRibbonDOMElement - Unable to parse domain ID: "+n)}return!0},A:function(){var n,t,i;if(!this.H)return!0;for(n=0,t=this.H.$$ge();t.$$mn();)i=t.$$cu(),i.a.DomainBlocked||++n;return n<=this.bn},w:function(){this.F&&this.F.C()},z:function(n,t,i){if(t!=="PopulateConvertToLinkedEntityMenu")return!1;if(this.Z=i.MenuId,this.J&&this.J!==3)_Ewa.w.a().a()?(this.X=this.X||this.ba.b(this.I,i.MenuId),i.MenuItems=this.X):(this.P=this.P||this.ba.a(this.I,i.MenuId),i.PopulationXML=this.P);else if(this.S===this.bc){this.d();var r=this;this.S=window.setInterval(function(){r.d()},this.bo)}return!0},d:function(){if(this.J!==2){this.Q--;Diag.a.a(593590104,0,100,"ConvertToLinkedEntityManager.PopulateDomainData - handshakeRetriesRemaining = {0}",this.Q);Diag.a.a(34415006,0,50,"ConvertToLinkedEntityManager:PopulateDomainData() - populating domains attempted.");this.J=1;_Ewa.en.g(this.E.d().a(),this.bk,this.bj,null,null);this.E.a(710)&&_Ewa.en.f(this.E.d().a(),this.bi,this.bh,null,null);return}},bD:function(n){var i,r,f,e,t;if(n.Result){if(i=n.Result,this.J=2,this.P=null,r=!1,i){Diag.a.a(39949271,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received {0} domains",i.length);f=_Ewa.ClientStringManager.a().a(1507);e=_Ewa.ClientStringManager.a().a(1509);for(var o=i,s=o.length,u=0;u<s;++u)if(t=o[u],!t.DomainId.StringId){if(this.I.push(t),t.DomainBlocked){Diag.a.a(595068755,0,50,"Domain: {0} is telemetry only, do not show in menu",t.Name);continue}this.H.b(t.DomainId.Id,t);t.Name===f?this.N=t.DomainId.Id.toString():t.Name===e&&(this.O=t.DomainId.Id.toString());r=!0}}r||(this.I=null);Diag.a.a(593590103,0,100,"ConvertToLinkedEntityManager.OnGetLinkedEntityServiceDomainsSuccess: atLeastOneDisplayableDomain = {0}",r.toString())}else this.I=null,this.J=3,this.P=null,this.Q>0&&this.d(),Diag.a.a(39949272,0,50,"OnGetLinkedEntityServiceDomainsSuccess: Received no result");this.bq();this.be||(this.bH(),this.be=!0)},bC:function(n){var t=_Ewa.T.a(n.b);Diag.a.a(34415007,0,15,"GetLinkedentityDomains failed [Errors: {0}].",_Ewa.g.a(t,","));this.I=null;this.J=3;this.bq()},bB:function(n){Diag.a.a(594613852,0,50,"OnGetLinkedEntityPowerBIDataSuccess");n.Result?this.M=n.Result:(this.M=null,Diag.a.a(594613851,0,50,"OnGetLinkedEntityPowerBIDataSuccess: Received no result"))},bA:function(n){var t=_Ewa.T.a(n.b);Diag.a.a(594613850,0,15,"OnGetLinkedEntityPowerBIDataFailure [Errors: {0}].",_Ewa.g.a(t,","));this.M=null},bz:function(){this.bs()&&this.G.w(this.U)},bG:function(n){if(this.F){var t=this.H.a(n).Name===this.bv();this.F.p=t}},bs:function(){var n=$$as(_Ewa.he,_Ewa.b.a(this.E).b()),i=!!n&&n.E(),r=this.G.a().e(),t;return i&&r===1&&this.G.a().b()?(t=_Ewa.k.a(_Ewa.cS,this.E.b(),12,this.E.i(),-2),this.K=new _Ewa.AQ(this.E,t.a(),this),!0):!1},v:function(n){this.F&&this.F.q(n)},x:function(n){this.F&&this.F.D(n)},m:function(){return this.n(this.N)},l:function(){return this.n(this.O)},n:function(n){var t=this.bw(n),i=this.c(n),r=this.D(n);return _Ewa.sF.a(t,i,r)},D:function(n){try{return this.H.a(parseInt(n)).Description}catch(t){}return _Ewa.ClientStringManager.a().a(1504)},c:function(n){try{return this.H.a(parseInt(n)).Name}catch(t){}return _Ewa.ClientStringManager.a().a(1496)},t:function(n){return n===this.N?"ewadata_StockLinkedEntity16":n===this.O?"ewadata_GeographyLinkedEntity16":"ewadata_ConvertToEntityIcon16"},u:function(n){return this.K?this.K.x(n,!1):!1},s:function(){return this.K?this.K.y():""},bw:function(n){return n===this.N?"ewadata_StockLinkedEntity32":n===this.O?"ewadata_GeographyLinkedEntity32":"ewadata_ConvertToEntityIcon32"},bu:function(n){try{return this.H.a(parseInt(n)).ExampleEntities}catch(t){}return _Ewa.ClientStringManager.a().a(1511)},bq:function(){this.Q<0&&Diag.a.a(37089859,0,10,"Out of GetLinkedEntityServiceDomain retries");(this.J===2||this.Q<0)&&window.clearInterval(this.S);this.Z&&this.E.v().w(this.Z)},bp:function(n,t,i){if(this.E.a(597)&&this.I){Diag.a.a(51659660,0,50,"ConvertToLinkedEntityManager.InvokeLinkedEntityTryAutoRefresh. ({0})",n);var r=this,u=function(n,u){return _Ewa.en.h(r.E.d().a(),_Ewa.n.a(n,t),_Ewa.n.b(u,i),null,null)},f=this;_Ewa.L.a(this.E.g(),u,function(n){return new _Ewa.bd(555,0,n,16,null)},null)}},bH:function(){this.bp("Auto-refresh on load",null,null)},bI:function(){if(this.E.a(597)&&this.I){if(this.L){Diag.a.a(51659661,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. A periodic auto-refresh check context already exists. No need to create another one");return}var n=this.E.c().s().HasAutoRefreshableLinkedEntityDomainsEver;if(!n){Diag.a.a(51659662,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book doesn't have any auto-refreshable domains. Periodic auto refresh check context will NOT be created");return}Diag.a.a(51659663,0,50,"ConvertToLinkedEntityManager.TryCreatePeriodicAutoRefreshCheckContext. Book has auto-refreshable domains. Creating periodic auto refresh check context");this.L=_Ewa.y.a().a(this.T,this.R,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck",!0,!1)}},bt:function(){Diag.a.a(51659664,0,50,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck. Checking after a {0} millisecond interval",this.R);this.bp("Periodic auto-refresh check",this.bg,this.bf)},by:function(n){if(_Ewa.Q.a(n)?(Diag.a.a(51659665,0,15,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. LinkedEntityTryAutoRefresh returned with errors [Errors: {0}].",_Ewa.g.a(n.Errors,",")),++this.V):this.V=0,System.a.a(this.L),this.V>=this.bm){Diag.a.a(51659666,0,10,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Failed too many consecutive times. Will stop trying to auto-refresh");this.L=null;return}Diag.a.a(51659667,0,50,"ConvertToLinkedEntityManager.OnCallPeriodicAutoRefreshCheckSuccess. Re-creating periodicAutoRefreshCheckContext");this.L=_Ewa.y.a().a(this.T,this.R,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck",!0,!1)},bx:function(n){var t=_Ewa.T.a(n.b);!t||!t.length?Diag.a.a(51659669,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed with an HTTP error"):Diag.a.a(51659668,0,15,"OnCallPeriodicAutoRefreshCheckFailure. LinkedEntityTryAutoRefresh failed [Errors: {0}].",_Ewa.g.a(t,","));System.a.a(this.L);this.L=_Ewa.y.a().a(this.T,this.R,"ConvertToLinkedEntityManager.CallPeriodicAutoRefreshCheck",!0,!1)}};_Ewa.sG=function(n){_Ewa.sG.initializeBase(this);this.h=n;this.j()};_Ewa.sG.a=function(n){n.b().b(_Ewa.bad.$$(_Ewa.fi),272,new _Ewa.sG(n))};_Ewa.sG.prototype={h:null,b:function(){var t=_Ewa.k.a(_Ewa.dI,this.h.b(),102,this.h.i(),-2),i=_Ewa.k.b(_Ewa.oU,this.h.b(),257,258),r=_Ewa.ch.a(this.h),n=this;_Ewa.f.cw(_Ewa.f.ws([t,i,r],this.du(),3),function(){n.i(n.h.b().a(_Ewa.fi,271,!1)||new _Ewa.sF(n.h,t.a(),i.a(),r.a()))},this.h.i(),3)}};_Ewa.Dg=function(n,t){this.g=t;this.c=n;this.e=this.g.a(871);this.e&&(this.f=5,this.d="Size106by76")};_Ewa.Dg.prototype={g:null,f:2,d:"Size64by48",c:null,e:!1,b:function(n,t){if(this.e)return this.l(n,t);var i=this.k(n,t);return i.b()},k:function(n,t){var r=this.c.c(t),u,f,i;if(n&&n.length>0){u=this.c.b();r.a().push(u);f=this.c.f("ConvertToLinkedEntitySeeMore",this.f,this.d,null);for(var o=n,h=o.length,e=0;e<h;++e)if((i=o[e],!i.DomainId.StringId)&&!i.DomainBlocked){var s=i.DomainId.Id.toString(),c=this.h(i.Name),l=i.Name;f.c(0,"Data.ConvertToLinkedEntityMenuItem_"+s,-1203788282,"QueryLinkedEntityGalleryIcon",i.Description,s,c,null,null,null)}Array.add(u.a(),f)}return r.a().length||Diag.a.a(34415008,0,15,"No domain data available"),r},l:function(n,t){var l=this.c.c(t),e=l.b(),o,r,i,c,f;if(n&&n.length>0){o=this.c.b();r=this.c.f("ConvertToLinkedEntityFeatured",this.f,this.d,null);for(var s=n,a=s.length,u=0;u<a;++u)if((i=s[u],!i.DomainId.StringId)&&!i.DomainBlocked){var h=i.DomainId.Id.toString(),v=this.h(i.Name),y=i.Name;r.a("Data.ConvertToLinkedEntityMenuItem_"+h,-1203788282,"QueryLinkedEntityGalleryIcon",0,h,v,null,null,i.Description,y)}c=r.b(!0);f=o.e();Array.add(f.ControlList,c);Array.insert(e.MenuSectionList,0,f)}return e},h:function(n){return n==="Stocks"?"Bank_32":n==="Geography"?"OpenMap_32":this.e?"ConvertToEntity_20":"ConvertToEntity_32"},a:function(n,t){var u=[],i,e,o,s,h;if(n)for(var f=n,c=f.length,r=0;r<c;++r)(i=f[r],i.DomainId.StringId)||i.DomainBlocked||(e=i.DomainId.Id.toString(),o=i.Name,Array.add(u,this.i(o,"-1203788282","QueryLinkedEntityMenuGalleryButtons",e)));return s=this.j(t,[Common.x.i("ConvertToLinkedEntitySeeMore",this.d,this.f.toString(),u)],!1),h=[s],Common.x.c(h)},j:function(n,t,i){return Common.x.b(n,i?Common.x.d(null,t):t[0],null,null,null,null,null)},i:function(n,t,i,r){return String.format('<GalleryButton InnerHTML="" Id="{0}" Command="{1}" QueryCommand="{2}" MenuItemId="{3}" ElementDimensions="{4}"/>',n,t,i,r,this.d)}};_Ewa.en=function(){};_Ewa.en.d=function(n,t,i,r,u,f,e,o,s){var h=n.a(1,s);return h.selectedRanges=t,h.serviceEndpoint=i,h.autodetect=r,h.conversionContext=u,_Ewa.i.a(n,"ConvertToLinkedEntity",h,f,e,o,4,null)};_Ewa.en.j=function(n,t,i,r,u,f){var e=n.a(1,f);return e.sheetName=t,_Ewa.i.a(n,"OnAutoDetectUIShown",e,i,r,u,4,null)};_Ewa.en.g=function(n,t,i,r,u){var f=n.a(1,u);return _Ewa.i.a(n,"GetLinkedEntityServiceDomains",f,t,i,r,4,null)};_Ewa.en.f=function(n,t,i,r,u){var f=n.a(1,u);return _Ewa.i.a(n,"GetLinkedEntityPowerBIData",f,t,i,r,4,null)};_Ewa.en.c=function(n,t,i,r,u,f){var e=n.a(1,f);return e.selectedRanges=t,_Ewa.i.a(n,"ConvertLinkedEntityToText",e,i,r,u,4,null)};_Ewa.en.k=function(n,t,i,r,u,f){var e=n.a(1,f);return e.activeCell=t,_Ewa.i.a(n,"RefreshLinkedEntities",e,i,r,u,4,null)};_Ewa.en.a=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.activeCell=t,o.isChangeObject=i,_Ewa.i.a(n,"GetLinkedEntityDisambiguationData",o,r,u,f,4,null)};_Ewa.en.m=function(n,t,i,r,u,f,e){var o=n.a(9,e);return o.activeCell=t,o.selectionIndex=i,_Ewa.i.a(n,"SelectLinkedEntityForDisambiguation",o,r,u,f,4,null)};_Ewa.en.l=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.activeCell=t,o.searchQuery=i,_Ewa.i.a(n,"SearchLinkedEntity",o,r,u,f,4,null)};_Ewa.en.i=function(n,t,i,r,u,f,e){var o=n.a(1,e);return o.activeCell=t,o.isBackward=i,_Ewa.i.a(n,"MoveToNextAmbiguousLinkedEntity",o,r,u,f,4,null)};_Ewa.en.b=function(n,t,i,r,u,f){var e=n.a(9,f);return e.activeCell=t,_Ewa.i.a(n,"CancelSearchLinkedEntity",e,i,r,u,4,null)};_Ewa.en.e=function(n,t,i,r,u,f){var e=n.a(1,f);return e.letyDomainId=t,_Ewa.i.a(n,"GetDataTypeSelectorData",e,i,r,u,4,null)};_Ewa.en.h=function(n,t,i,r,u){var f=n.a(1,u);return _Ewa.i.a(n,"LinkedEntityTryAutoRefresh",f,t,i,r,0,null)};_Ewa.Di=function(n){_Ewa.Di.initializeBase(this,[n])};_Ewa.Di.prototype={dispose:function(){Common.App.Enrichment.g.prototype.dispose.call(this)}};_Ewa.md=function(n,t,i){this.m=Function.createDelegate(this,this.n);this.b=this.cq;this.d=this.cp;_Ewa.md.initializeBase(this,[n,null]);this.i=t;this.l=i;_Ewa.bn.a(t).a(this);this.i.H(this.m)};_Ewa.md.a=function(n,t){var u=n.m(),i=document.getElementById(u+"m_enrichmentTaskPane"),f,r,e;return i||(i=CommonUI.a.a("div",n.m()+"m_enrichmentTaskPane","cui-taskpane"),f=document.getElementById(u+"novTaskpaneBody"),f.appendChild(i)),r=n.b(),e=r.a(_Ewa.md,257,!1)||r.b(_Ewa.md,257,new _Ewa.md(i,n,t)),e};_Ewa.md.prototype={l:null,N:function(n){this.get_events().addHandler("EnrichmentTaskPaneRemoved",n)},R:function(n){this.get_events().removeHandler("EnrichmentTaskPaneRemoved",n)},e:function(n){this.cv("EnrichmentTaskPaneOnFocus",n)},f:function(n){this.cw("EnrichmentTaskPaneOnFocus",n)},cq:function(){return _Ewa.Uq.prototype.cq.call(this)},cp:function(n){return _Ewa.Uq.prototype.cp.call(this,n),this.cn("EnrichmentTaskPaneVilibilityChanged",null),n},bs:function(){return this.cq()},bb:function(){return"ETP"},a:function(){return 10},s:function(){return"ewanov_linkedrecordPane"},t:function(){return"Enrichment"},P:function(){return 300},C:function(){return this.cl()},k:!1,i:null,j:function(){},O:function(){},g:function(){return this.k},h:function(){return this.k},r:function(){},dispose:function(){this.i&&this.i.I(this.m);this.i=null;this.l=null;_Ewa.Uq.prototype.dispose.call(this)},y:function(n,t){return t||this.cn("EnrichmentTaskPaneOnFocus",null),!t},dp:function(n){return _Ewa.a.g(this.C(),n)},ct:function(){},bE:function(){},c:function(n){this.k=n;var t=this.l;this.cp(n);n&&t.c().length>0&&(!t.a()||t.a().a().a()!==10||t.e())&&t.d(this,!0);t.b();n||(_Ewa.b.a(this.i).y(!0,!1),this.i.A())},Q:function(){return!1},n:function(){this.c(!1)}};_Ewa.sH=function(n){_Ewa.sH.initializeBase(this);this.h=n;this.j()};_Ewa.sH.a=function(n){n.b().b(_Ewa.bad.$$(_Ewa.oU),258,new _Ewa.sH(n))};_Ewa.sH.prototype={k:null,l:null,n:function(){if(!this.k){var n=this;this.k=_Ewa.f.cw(_Ewa.ch.a(this.h),function(t){n.l=_Ewa.md.a(n.h,t.a())},this.du(),3)}return this.k},h:null,b:function(){var t=_Ewa.k.a(Sys.IDisposable,this.h.b(),203,this.du(),-2),i=_Ewa.k.a(Object,this.h.b(),155,this.du(),-2),r=this,n=this;_Ewa.f.cw(_Ewa.f.tc(_Ewa.f.ws([t,i],this.du(),3),function(){return r.n()},this.du()),function(){n.i(n.l)},this.du(),3)},dispose:function(){this.h=null;this.k=null;this.l=null;_Ewa.cw.prototype.dispose.call(this)}};_Ewa.Dh=function(n){_Ewa.Dh.initializeBase(this,[Common.a.b().c(),Common.a.b().f(),Common.a.b().i(),Common.a.b().b(),Common.a.c()]);this.f=n;this.f.e(this.r)};_Ewa.Dh.prototype={f:null,z:function(){return this.f.C()},C:function(){this.f.b()||this.f.c(!0)},B:function(){this.f.c(!1)},dispose:function(){this.f&&(this.f.f(this.r),this.f=null);Common.App.Enrichment.a.prototype.dispose.call(this)}};_Ewa.AP=function(n,t,i,r){_Ewa.AP.initializeBase(this,[!1]);this.c=n;this.a=i.b(n,t,"",_Ewa.r.a(11),r,"AutoDetectPointerDown",_Ewa.ClientStringManager.a().a(1516)+"...")};_Ewa.AP.prototype={c:null,a:null,b:function(){return this.a.b()},dispose:function(){this.a.dispose();this.c=null;_Ewa.WR.prototype.dispose.call(this)},f:function(n){return this.a.c(n,!1)},h:function(n,t,i,r){this.a.l(_Ewa.ClientStringManager.a().a(1516)+" "+n,t,r,!1);this.a.k(i,t,r,!1)},e:function(n,t){var r=_Ewa.b.a(this.c),u=r.h().b(n),i=r.x(n,u,!1),f=r.n(u).P(),h;if(i&&i.a.a>=0&&i.a.b>=0&&f.c()>i.c()+160){var e=i.b.a+this.b(),o=i.a.b+this.b(),s=!1;if(e+160>f.b.a&&(e=i.a.a-this.b(),s=!0),h=o<f.a.b+this.b(),h){if(r.h().m()){this.d();return}o=f.a.b+this.b()}this.a.g(t,"AutoDetectHover",u);this.g(e,o,r.d(),u,s)}else this.d()},g:function(n,t,i,r,u){this.a.a(n,t,i,r,!1,u)},d:function(){this.a.d()}};_Ewa.AQ=function(n,t,i){this.n=Function.createDelegate(this,this.w);this.l=Function.createDelegate(this,this.B);this.o=Function.createDelegate(this,this.E);this.m=Function.createDelegate(this,this.C);this.h=Function.createDelegate(this,this.D);this.s=Function.createDelegate(this,this.A);this.u=Common.c.e();_Ewa.AQ.initializeBase(this,[!1]);this.b=n;this.d=i;i.d();this.c=new _Ewa.AP(n,this.s,t,"");this.a=_Ewa.b.a(this.b);this.a.a().k(this.h);this.a.f().p(this.h);this.a.t(this.m);this.b.H(this.o);this.b.T(this.l);this.j=$$as(_Ewa.he,this.a.b());this.k()};_Ewa.AQ.prototype={d:null,c:null,a:null,j:null,b:null,f:-1,i:null,e:-1,g:!1,p:function(){if(this.b.k()&&this.b.a(175)&&this.b.a(179)){var n=new _Ewa.bY(this.b.e());if(n.b())return!1}return this.e!==-1},dispose:function(){if(this.a&&this.a.a().l(this.h),this.b){var n=this.b;n.I(this.o);n.V(this.l);_Ewa.b.a(n).w(this.m)}System.a.a(this.c);this.c=null;this.a=null;this.b=null;_Ewa.WR.prototype.dispose.call(this)},q:function(){this.w(null,!1);this.f=-1;this.c.d()},v:function(){this.p()&&this.f!==-1&&this.d.y()},x:function(n,t){for(var r,f,e=new _Ewa.o(n.a===1?1:n.a-1,n.b,n.d,n.c,!0,!1),o=this.a.B(e),u=o,s=u.length,i=0;i<s;++i)if(r=u[i],_Ewa.hM.isInstanceOfType(r)&&(f=r,this.r(n,t,f)))return!0;return!1},t:function(){this.p()&&this.f!==-1&&(this.c.f(1).a(),this.d.p(this.e,!0,this.i),Diag.a.a(594612633,0,50,"AutoDetectManager.Convert (AssistedAutoConvertMenuConvertClicked)"),this.e=-1)},y:function(){var n=new Sys.StringBuilder(_Ewa.ClientStringManager.a().a(1480));if(this.e!==-1){n.append(" ");try{n.append(this.d.c(this.e.toString()))}catch(t){Diag.a.a(593847515,0,10,"AutoDetectManager.GetButtonAccessibilityString: Could not obtain name from domain {0}",this.e)}}return n.append(" "),n.append(_Ewa.ClientStringManager.a().a(this.u?1482:1481)),n.toString()},D:function(){this.p()&&this.a&&this.k()},E:function(){this.q()},A:function(){this.t();this.b.isChangeGateEnabled("OfficeVSO:3929469_FocusGridAfterAutoDetectConvert")&&_Ewa.b.a(this.b).y(!0,!1)},w:function(n,t){if(t)this.F(this.i);else{var i=[29];this.a.k().a(i);this.a.k().b(null,i,!0)}},B:function(){this.z()&&this.c.d();var n=this.a.a().e();n===1&&this.k()},C:function(){var n=this.a.a().b(),t=this.a.a().e();n&&t===1&&this.k()},r:function(n,t,i){var f=new _Ewa.o(i.a,i.b,i.d===1048576?i.d:i.d+1,i.c,!0,!1),r,u;return f.h(n)?(t&&(r=i,r&&r.s!==this.f&&(this.f=r.s,u=r.s.toString(),this.c.h(this.d.c(u),this.d.D(u),this.d.t(u),1)),this.e=r.s,this.i=i),!0):!1},k:function(){var r,t;if(this.d){var f=!!this.j&&this.j.E(),e=this.b.a(476)?this.a.a().d().d():this.a.a().a().j(),o=this.a.a().e();if(!f||!e||o!==1){this.q();return}for(var n=this.a.a().b(),s=new _Ewa.o(n.a===1?1:n.a-1,n.b,n.d,n.c,!0,!1),h=this.a.B(s),u=h,c=u.length,i=0;i<c;++i)if(r=u[i],_Ewa.hM.isInstanceOfType(r))if(t=r,this.b.a(780))switch(t.v){case 3:if(this.r(n,!0,t)){Diag.a.a(593831632,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.c.e(n,this.n);this.g||(this.g=!0,this.v());return}}else if(this.r(n,!0,t)){Diag.a.a(594612634,0,50,"AutoDetectManager.ShowOrHideButtonOnGrid (AssistedAutoConvertTriggered)");this.c.e(n,this.n);this.g||(this.g=!0,this.v());return}this.q()}},F:function(n){var t=[29];this.a.k().b(n,t,!0);this.a.k().c(t,null,null)},z:function(){return this.b.c().b()&&_Ewa.A.a(this.b.j())}};_Ewa.De.registerClass("_Ewa.De",null,_Ewa.jJ);_Ewa.sE.registerClass("_Ewa.sE",_Ewa.Z);_Ewa.Df.registerClass("_Ewa.Df",null,Sys.IDisposable);_Ewa.sG.registerClass("_Ewa.sG",_Ewa.pR.$$(_Ewa.fi));_Ewa.Di.registerClass("_Ewa.Di",Common.App.Enrichment.g);_Ewa.md.registerClass("_Ewa.md",_Ewa.Uq,_Ewa.oU,Sys.IDisposable,_Ewa.bao,_Ewa.uY);_Ewa.sH.registerClass("_Ewa.sH",_Ewa.pR.$$(_Ewa.oU));_Ewa.Dh.registerClass("_Ewa.Dh",Common.App.Enrichment.a);_Ewa.AP.registerClass("_Ewa.AP",_Ewa.WR);_Ewa.AQ.registerClass("_Ewa.AQ",_Ewa.WR);Type.registerNamespace("_Ewa");_Ewa.VL=function(){};_Ewa.VL.a=function(){_Ewa.j.a(function(n){_Ewa.sH.a(n);_Ewa.sG.a(n);_Ewa.sE.a(n)})};_Ewa.VL.a();